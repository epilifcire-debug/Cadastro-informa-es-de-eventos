// SERVICE WORKER v6 - PWA Eventos
const CACHE_NAME="eventos-pwa-v6";const URLS_TO_CACHE=["./","./index.html","./gerenciar-lote.html","./style.css","./script.js","./manifest.json","./img/logo.png","./img/logo-48.png","./img/logo-96.png","./img/logo-144.png","./img/logo-192.png","./img/logo-512.png","https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"];
self.addEventListener("install",e=>{console.log("ðŸ“¦ Instalando SW...");e.waitUntil(caches.open(CACHE_NAME).then(c=>c.addAll(URLS_TO_CACHE)).then(()=>self.skipWaiting()))});
self.addEventListener("activate",e=>{console.log("âœ… SW ativo:",CACHE_NAME);e.waitUntil(caches.keys().then(keys=>Promise.all(keys.map(k=>{if(k!==CACHE_NAME){console.log("ðŸ§¹ Limpando cache antigo:",k);return caches.delete(k)}}))));self.clients.claim()});
self.addEventListener("fetch",e=>{if(!e.request.url.startsWith(self.location.origin)&&!e.request.url.includes("cdnjs.cloudflare.com"))return;e.respondWith(caches.match(e.request).then(res=>{if(res)return res;return fetch(e.request).then(netRes=>{if(e.request.method==="GET"&&netRes.status===200&&!netRes.url.includes("chrome-extension")){const clone=netRes.clone();caches.open(CACHE_NAME).then(c=>c.put(e.request,clone))}return netRes}).catch(()=>{if(e.request.mode==="navigate")return caches.match("./index.html")})}))});
self.addEventListener("message",e=>{if(e.data==="SKIP_WAITING"){console.log("âš¡ Atualizando SW agora...");self.skipWaiting()}});
